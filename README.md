# tg搜索平台

## 文档信息
- **文档版本**: 1.0.0
- **创建日期**: 2025-01-22
- **作者**: @产品/架构
- **© 项目组/组织**

## 1. 概述

### 1.1 模块定位
网站端搜索平台是面向普通用户的Web应用，提供直观、高效的Telegram内容搜索服务。用户可以通过关键字搜索、过滤器筛选等方式快速找到所需的Telegram内容。

### 1.2 核心价值
- 提供便捷的Web搜索界面
- 支持多维度内容过滤
- 实现快速精准的搜索体验
- 满足用户个性化搜索需求

## 2. 功能需求

### 2.1 搜索功能

#### 2.1.1 基础搜索
- **关键字搜索**: 支持单个或多个关键字搜索
- **搜索建议**: 实时显示搜索建议和历史记录
- **搜索纠错**: 自动识别拼写错误并提供建议
- **热门搜索**: 展示当前热门搜索关键字

#### 2.1.2 高级搜索
- **精确匹配**: 使用引号进行精确短语搜索
- **模糊搜索**: 支持拼音、同义词搜索
- **正则表达式**: 支持高级用户使用正则表达式
- **组合搜索**: 支持AND、OR、NOT逻辑操作

#### 2.1.3 搜索范围
- **全局搜索**: 在所有索引内容中搜索
- **指定来源**: 在特定群组或频道中搜索
- **内容类型**: 按消息类型（文本、媒体、链接）搜索
- **时间范围**: 按时间段筛选搜索结果

### 2.2 过滤器功能

#### 2.2.1 内容类型过滤
- **群组消息**: 筛选来自群组的消息
- **频道消息**: 筛选来自频道的消息
- **私聊消息**: 筛选私聊内容（如有权限）
- **媒体文件**: 筛选包含图片、视频、文档的消息
- **链接消息**: 筛选包含外部链接的消息

#### 2.2.2 时间过滤
- **预设时间**: 最近1小时、24小时、7天、30天
- **自定义时间**: 用户自定义开始和结束时间
- **时间排序**: 按时间正序或倒序排列

#### 2.2.3 来源过滤
- **群组筛选**: 按特定群组名称筛选
- **频道筛选**: 按特定频道名称筛选
- **用户筛选**: 按发送者筛选（如有权限）
- **语言筛选**: 按内容语言筛选

#### 2.2.4 质量过滤
- **消息长度**: 按消息字符数筛选
- **互动数量**: 按点赞、转发数筛选
- **相关性评分**: 按搜索相关性筛选

### 2.3 结果展示功能

#### 2.3.1 结果列表
- **卡片式布局**: 每条结果以卡片形式展示
- **关键字高亮**: 搜索关键字在结果中高亮显示
- **内容预览**: 显示消息内容摘要
- **元信息显示**: 显示来源、时间、类型等信息

#### 2.3.2 结果操作
- **详情查看**: 点击查看完整消息内容
- **来源跳转**: 跳转到原始Telegram消息（如有权限）
- **收藏功能**: 收藏感兴趣的搜索结果
- **分享功能**: 分享搜索结果给其他用户

#### 2.3.3 分页与排序
- **分页展示**: 支持分页浏览搜索结果
- **无限滚动**: 可选的无限滚动加载模式
- **排序选项**: 按相关性、时间、热度排序
- **结果统计**: 显示搜索结果总数和用时

### 2.4 用户功能

#### 2.4.1 个人中心
- **搜索历史**: 查看和管理搜索历史
- **收藏管理**: 管理收藏的搜索结果
- **个性化设置**: 设置搜索偏好和界面选项
- **使用统计**: 查看个人使用统计数据
- **机器人管理**: 查看和管理个人Telegram机器人
- **克隆功能**: 克隆现有机器人配置创建新实例

#### 2.4.3 机器人状态监控
- **运行状态**: 实时查看机器人在线状态和运行情况
- **性能指标**: 监控机器人响应时间、处理消息数量等
- **错误日志**: 查看机器人运行错误和异常信息
- **连接状态**: 监控机器人与Telegram API的连接状态

#### 2.4.4 机器人克隆管理
- **配置克隆**: 复制现有机器人的配置参数
- **快速部署**: 基于克隆配置快速创建新机器人实例
- **差异对比**: 对比不同机器人配置的差异
- **批量操作**: 支持批量克隆和部署操作

#### 2.4.5 用户设置
- **界面主题**: 支持明暗主题切换
- **语言设置**: 支持多语言界面
- **搜索偏好**: 设置默认搜索选项
- **隐私设置**: 设置搜索历史保存策略
- **机器人通知**: 设置机器人状态变更通知偏好
- **克隆权限**: 管理机器人克隆和分享权限

## 3. 界面设计规范

### 3.1 整体布局
- **响应式设计**: 适配PC、平板、手机等设备
- **简洁风格**: 采用简洁现代的设计风格
- **色彩搭配**: 使用舒适的色彩搭配，支持主题切换
- **字体规范**: 使用易读的字体，支持多语言显示

### 3.2 页面结构
```
┌─────────────────────────────────────┐
│              页面头部                │
│   Logo + 导航 + 机器人状态 + 用户菜单 │
├─────────────────────────────────────┤
│              搜索区域                │
│      搜索框 + 搜索按钮 + 高级选项     │
├─────────────────────────────────────┤
│          过滤器面板（可折叠）         │
│    内容类型 + 时间 + 来源 + 质量     │
├─────────────────────────────────────┤
│              结果区域                │
│        搜索结果列表 + 分页           │
├─────────────────────────────────────┤
│              页面底部                │
│        版权信息 + 帮助链接           │
└─────────────────────────────────────┘
```

### 3.3 机器人管理页面结构
```
┌─────────────────────────────────────┐
│              页面头部                │
│   Logo + 导航 + 机器人状态 + 用户菜单 │
├─────────────────────────────────────┤
│            机器人概览区域             │
│     运行状态 + 性能指标 + 快捷操作    │
├─────────────────────────────────────┤
│              功能选项卡              │
│   状态监控 | 克隆管理 | 配置设置     │
├─────────────────────────────────────┤
│              内容区域                │
│        根据选项卡显示对应内容         │
├─────────────────────────────────────┤
│              操作面板                │
│      克隆按钮 + 部署按钮 + 设置      │
└─────────────────────────────────────┘
```

### 3.4 交互规范
- **搜索响应**: 搜索结果在2秒内返回
- **实时反馈**: 提供加载状态和进度提示
- **错误处理**: 友好的错误提示和处理建议
- **快捷操作**: 支持键盘快捷键操作

## 4. API接口规范

### 4.1 搜索接口
```http
GET /api/search
Parameters:
- q: 搜索关键字 (required)
- type: 内容类型过滤 (optional)
- source: 来源过滤 (optional)
- timeRange: 时间范围 (optional)
- page: 页码 (optional, default: 1)
- size: 每页大小 (optional, default: 20)
- sort: 排序方式 (optional, default: relevance)

Response:
{
  "code": 200,
  "message": "搜索成功",
  "data": {
    "total": 1000,
    "page": 1,
    "size": 20,
    "results": [
      {
        "id": "msg_123",
        "content": "消息内容",
        "source": "群组名称",
        "type": "text",
        "timestamp": "2025-01-22T10:00:00Z",
        "relevance": 0.95
      }
    ]
  }
}
```

### 4.2 建议接口
```http
GET /api/suggestions
Parameters:
- q: 输入关键字 (required)
- limit: 建议数量 (optional, default: 10)

Response:
{
  "code": 200,
  "data": {
    "suggestions": [
      "建议关键字1",
      "建议关键字2"
    ]
  }
}
```

### 4.3 热门搜索接口
```http
GET /api/trending
Parameters:
- limit: 返回数量 (optional, default: 10)
- timeRange: 时间范围 (optional, default: 24h)

Response:
{
  "code": 200,
  "data": {
    "trending": [
      {
        "keyword": "热门关键字",
        "count": 1000,
        "trend": "up"
      }
    ]
  }
}
```

### 4.4 机器人状态接口
```http
GET /api/bot/status
Parameters:
- botId: 机器人ID (optional, 不传则返回用户所有机器人)

Response:
{
  "code": 200,
  "message": "获取成功",
  "data": {
    "bots": [
      {
        "id": "bot_123",
        "name": "我的搜索机器人",
        "status": "online",
        "uptime": "2d 5h 30m",
        "messageCount": 1500,
        "responseTime": 120,
        "lastActive": "2025-01-22T10:00:00Z",
        "errorCount": 2,
        "connectionStatus": "connected"
      }
    ]
  }
}
```

### 4.5 机器人克隆接口
```http
POST /api/bot/clone
Parameters:
{
  "sourceBotId": "bot_123",
  "newBotName": "克隆机器人",
  "copySettings": {
    "searchConfig": true,
    "filterRules": true,
    "responseTemplates": true,
    "permissions": false
  }
}

Response:
{
  "code": 200,
  "message": "克隆成功",
  "data": {
    "newBotId": "bot_456",
    "cloneStatus": "completed",
    "deploymentUrl": "/bot/deploy/bot_456"
  }
}
```

### 4.6 机器人部署接口
```http
POST /api/bot/deploy
Parameters:
{
  "botId": "bot_456",
  "deploymentConfig": {
    "environment": "production",
    "autoStart": true,
    "resources": {
      "cpu": "1",
      "memory": "512Mi"
    }
  }
}

Response:
{
  "code": 200,
  "message": "部署成功",
  "data": {
    "deploymentId": "deploy_789",
    "status": "deploying",
    "estimatedTime": "2-3分钟"
  }
}
```

## 5. 性能要求

### 5.1 响应时间
- **页面加载**: 首屏加载时间 < 3秒
- **搜索响应**: 搜索结果返回时间 < 2秒
- **过滤操作**: 过滤器应用时间 < 1秒
- **分页切换**: 分页加载时间 < 1秒

### 5.2 并发性能
- **并发用户**: 支持1000+并发用户
- **搜索QPS**: 支持500+ QPS搜索请求
- **系统可用性**: 99.5%以上可用性

### 5.3 用户体验
- **界面流畅**: 60fps流畅动画效果
- **响应式**: 完美适配各种屏幕尺寸
- **无障碍**: 支持键盘导航和屏幕阅读器

## 6. 安全要求

### 6.1 数据安全
- **HTTPS**: 全站使用HTTPS加密传输
- **输入验证**: 严格验证用户输入，防止XSS攻击
- **SQL注入**: 防止SQL注入攻击
- **CSRF保护**: 实施CSRF令牌保护

### 6.2 隐私保护
- **搜索历史**: 用户可选择是否保存搜索历史
- **数据匿名**: 统计数据进行匿名化处理
- **权限控制**: 严格控制内容访问权限

## 7. 兼容性要求

### 7.1 浏览器支持
- **现代浏览器**: Chrome 80+, Firefox 75+, Safari 13+, Edge 80+
- **移动浏览器**: iOS Safari 13+, Android Chrome 80+
- **功能降级**: 旧版浏览器提供基础功能

### 7.2 设备适配
- **桌面端**: 1920x1080及以上分辨率优化
- **平板端**: 768px-1024px宽度适配
- **手机端**: 320px-768px宽度适配

## 8. 测试要求

### 8.1 功能测试
- **搜索功能**: 各种搜索场景的功能测试
- **过滤器**: 所有过滤器组合的测试
- **用户操作**: 完整用户操作流程测试

### 8.2 性能测试
- **负载测试**: 模拟高并发用户访问
- **压力测试**: 测试系统极限性能
- **稳定性测试**: 长时间运行稳定性测试

### 8.3 兼容性测试
- **浏览器测试**: 各主流浏览器兼容性测试
- **设备测试**: 不同设备和分辨率测试
- **网络测试**: 不同网络环境下的性能测试

## 9. 部署要求

### 9.1 环境配置
- **Web服务器**: Nginx 1.18+
- **应用服务器**: Node.js 16+ 或 Java 11+
- **数据库**: MySQL 8.0+ + Meilisearch 1.x+
- **缓存**: Redis 6.0+

### 9.2 部署架构
- **负载均衡**: 多实例负载均衡部署
- **CDN加速**: 静态资源CDN分发
- **容器化**: Docker容器化部署
- **监控告警**: 完善的监控和告警机制

---

## 10. UI原型图

### 10.1 机器人管理界面原型
- **文件**: `website-bot-management-ui.svg`
- **描述**: 展示网站端机器人管理的完整界面，包括状态监控、性能图表、错误日志和操作面板
- **功能**: 实时状态监控、批量操作、详细状态表格

### 10.2 机器人克隆功能原型
- **文件**: `bot-clone-feature-ui.svg`
- **描述**: 展示机器人克隆功能的详细操作流程和配置选项
- **功能**: 源机器人选择、克隆配置、部署设置、预估信息

---

**修改历史**:
- v1.0.0 (2025-01-22): 初始版本，完成基础功能规格设计
- v1.1.0 (2025-01-22): 新增机器人管理功能，包括状态监控和克隆功能
  - 新增机器人状态监控功能
  - 新增机器人克隆管理功能
  - 新增相关API接口规范
  - 新增UI原型图设计
  - 更新页面结构和交互规范
